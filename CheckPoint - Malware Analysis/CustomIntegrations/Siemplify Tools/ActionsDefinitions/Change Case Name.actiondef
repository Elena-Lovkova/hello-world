{
  "Name": "Change Case Name",
  "Description": "The action changes the case's name (title)",
  "Script": "from SiemplifyAction import *\nimport requests\n\n\ndef main():\n    siemplify = SiemplifyAction()\n    siemplify.script_name = \"ChangeCaseName\"\n    \n    outpu_message = \"\"\n    result_value = \"false\"\n    try:\n        try:\n            api_key = siemplify.api_key\n        except:\n            api_key = siemplify._api_key\n        session = requests.session()\n        session.verify = False\n        change = True\n        if siemplify.parameters.get('Only If First Alert', 'false').lower() == 'true':\n            if siemplify.current_alert.identifier != siemplify.case.alerts[-1].identifier:\n                change = False\n        if change:\n            session.headers = {'AppKey': api_key, 'Content-Type': 'application/json', 'Accept': 'application/json'}\n            res = session.post('https://localhost:8443/api/external/v1/cases/RenameCase',\n                               json={\"caseId\": siemplify.case_id, \"title\": siemplify.parameters['New Name']})\n        \n            res.raise_for_status()\n        \n            output_message = \"Case's title changed to: {}\".format(siemplify.parameters['New Name'])\n            result_value = 'true'\n        else:\n            output_message = \"Case's title not changed, not first alert in the case\"\n            result_value = 'true'\n    except Exception as e:\n        output_message = \"An error occured: \" + e.message\n        siemplify.LOGGER.error(outpu_message)\n        siemplify.LOGGER.exception(e)\n    \n    siemplify.end(output_message, result_value)\n\n\nif __name__ == \"__main__\":\n    main()",
  "IntegrationIdentifier": "Siemplify Tools",
  "ScriptResultName": "ScriptResult",
  "DynamicResultsMetadata": [
    {
      "ResultName": "JsonResult",
      "ResultExample": "{}",
      "ShowResult": true
    }
  ],
  "Creator": "Alon",
  "IsEnabled": true,
  "IsCustom": true,
  "IsSystem": false,
  "Version": 12.0,
  "TimeoutSeconds": 300,
  "Parameters": [
    {
      "CustomActionId": 0,
      "IsMandatory": true,
      "DefaultValue": "",
      "Description": "The new name of the case",
      "Name": "New Name",
      "Value": "",
      "Type": 0,
      "OptionalValues": null,
      "OptionalValuesJson": null,
      "Id": 0,
      "CreationTimeUnixTimeInMs": 1598424406934,
      "ModificationTimeUnixTimeInMs": 1598424406934
    },
    {
      "CustomActionId": 0,
      "IsMandatory": false,
      "DefaultValue": "false",
      "Description": "If marked as True, will only change the case's name if the action was executed from the first alert in the case",
      "Name": "Only If First Alert",
      "Value": "false",
      "Type": 1,
      "OptionalValues": null,
      "OptionalValuesJson": null,
      "Id": 0,
      "CreationTimeUnixTimeInMs": 1598424406934,
      "ModificationTimeUnixTimeInMs": 1598424406934
    }
  ],
  "DefaultResultValue": "",
  "PythonVersion": "None",
  "Id": 0,
  "CreationTimeUnixTimeInMs": 1596620752565,
  "ModificationTimeUnixTimeInMs": 1598424406931
}